<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'/>

    <meta name="description" content="Knockout CRUD">
    <meta name="author" content="Slavko">
    <link rel="icon" href="favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <meta http-equiv="PRAGMA" content="NO-CACHE" />

    <title>Admin Module</title>
  
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.css" rel="stylesheet" type="text/css" />
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.css" rel="stylesheet" type="text/css" />

    <link href="css/font-awesome.css" rel="stylesheet" type="text/css" />
    <link href="css/SLGrid.css" rel="stylesheet" type="text/css" />

    <!-- Custom styles for this template -->
    <link href="css/dashboard.css" rel="stylesheet" />

    <style type="text/css">
        @import url(//fonts.googleapis.com/css?family=Kaushan+Script);
        .navbar-brand 
        {
            font-size: 20px;
            font-family: 'Kaushan Script', cursive;
        }
    </style>

    <style type="text/css">
        body { font-family: 'Source Sans Pro', sans-serif; }
        td { padding:10px;  vertical-align:text-top; }
    </style>


    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/knockout/3.1.0/knockout-min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/knockout.mapping/2.4.1/knockout.mapping.js"></script>

    <script src="SLGridALL.js" type="text/javascript"></script>

 
    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="js/ie-emulation-modes-warning.js"></script>
    <script src="js/docs.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="js/ie10-viewport-bug-workaround.js"></script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script type="text/javascript">
        function Trace(obj) {
            if (window.console && window.console.log)
                window.console.log(obj.toString());
        }
    </script>

  </head>

  <body>

 <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">KnockoutCRUD </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="#">Dashboard</a></li>
            <li><a href="#">Settings</a></li>
            <li><a href="#">Profile</a></li>
            <li><a href="#">Help</a></li>
          </ul>
          <form class="navbar-form navbar-right">
            <input type="text" class="form-control" placeholder="Search...">
          </form>
        </div>
      </div>
    </nav>

    <div class="container-fluid">
      <div class="row">

        <div class="col-sm-3 col-md-2 sidebar">
           
          <div class="well"> 
          <ul class="nav nav-sidebar">
            <li id="Overview" class="active"><a href="#">Overview</a></li>
            <li id="AdminModule"><a href="#">Admin Module</a></li>
          </ul>
          </div>

          <div class="well"> 
           <i>Steps</i>
          <ul class="nav nav-sidebar">
            <li id="Person"><a href="#">Person</a></li>
            <li id="PersonList"><a href="#">PersonList</a></li>
            <li id="PersonDB"><a href="#">PersonDB</a></li>
            <li id="ViewModels"><a href="#">View Models</a></li>
            <li id="EntityListTemplates"><a href="#">List templates</a></li>
            <li id="Bindings"><a href="#">Bindings</a></li>
          </ul>
          </div>

          <div class="well"> 
          <i>Features</i>
          <ul class="nav nav-sidebar">
            <li id="Widgets"><a href="#">Widgets</a></li>
            <li id="Relations"><a href="#">1:N Relations</a></li>
          </ul>
          </div>
        </div>

        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
          <h2 class="page-header">SLGrid - client jQuery/Knockout component</h2>
          <h3>Features</h3>
          <div class="row placeholders">
            <div class="col-xs-6 col-sm-3 placeholder">
              <img data-src="holder.js/60x60/auto/sky/text:DB" class="img-responsive" alt="Generic placeholder thumbnail">
              <h4>Any Database</h4>
              <span class="text-muted">Adapater for each database</span>
            </div>
            <div class="col-xs-6 col-sm-3 placeholder">
              <img data-src="holder.js/60x60/auto/vine/text:Web" class="img-responsive" alt="Generic placeholder thumbnail">
              <h4>Any Web App Framework</h4>
              <span class="text-muted">Like PHP, ASP.NET MVC, Java ...</span>
            </div>
            <div class="col-xs-6 col-sm-3 placeholder">
              <img data-src="holder.js/60x60/auto/lava/text:Grid" class="img-responsive" alt="Generic placeholder thumbnail">
              <h4>Grid</h4>
              <span class="text-muted">Standard grid features: pagination, search, sort ...</span>
            </div>
          </div>

          <div class="row placeholders">
            <div class="col-xs-6 col-sm-3 placeholder">
              <img data-src="holder.js/60x60/auto/gray/text:Widgets" class="img-responsive" alt="Generic placeholder thumbnail">
              <h4>Knockout Widgets</h4>
              <span class="text-muted">Each grid cell can host Knockout widget (dropdown, typeahead, date picker, ...) for presentation of field value</span>
            </div>
            <div class="col-xs-6 col-sm-3 placeholder">
              <img data-src="holder.js/60x60/auto/industrial/text:Templates" class="img-responsive" alt="Generic placeholder thumbnail">
              <h4>Templates</h4>
              <span class="text-muted">SLGrid generates row and form templates. Form templates for Bootstrap popovers. You can provide you own templates.</span>
            </div>
            <div class="col-xs-6 col-sm-3 placeholder">
              <img data-src="holder.js/60x60/auto/social/text:Relations" class="img-responsive" alt="Generic placeholder thumbnail">
              <h4>UI for 1:N relations </h4>
              <span class="text-muted">Each row has expanding panel presenting detail information or the children objects of the row</span>
            </div>
          </div>

          <!--<h2 class="sub-header">Section</h2>-->
          <div class="table-responsive">

            <div id="OverviewPanel" class="entity-panel" style="display:none;">
                <p>
                <i><b>SLGrid</b></i> is free open source software, available under the MIT license.<br />
                <i><b>SLGrid</b></i> also has professional support and maintenance packages that can be purchased 
                <br />from the authors to provide assistance with questions you might have.
                <a href="mailto:slavko.parezanin@gmail.com">ask for support</a>.
                </p>

                <p>
                    Core component is <i><b>SLGrid</b></i>, developed as jQuery Knockout Widget using custom bindings. <br />
                    It is jQuery client component that can be used in any web application framewrok. 
                    <br /><br />
               
                    SLGrid uses Knockout which does declarative bindings connecting parts of UI to data model.<br /> 
                    The same entity model (document) can be presented (bound) in many views like: 
                    <ul>
                    <li>Row view</li>
                    <li>Row edit view</li>
                    <li>Form view</li>
                    <li>Form edit view</li>
                    <li>...</li>
                    </ul>
                </p>

                <br />
                Here is the sample of the usage of SLGrid component.<br />
                We can see advantages of Knockout widgets used in cells of SLGrid.
                <br />
                <br />

                <br/>

                <h2>Steps of usage of SLGrid</h2>
                <br/>
                <h4>1) Define classes Person, PersonList, PersonDB (SLGen can generate classes from DB definition)</h4>

<b><i>Person</i></b>
<pre><code class="javascript">
 var Person = function (data, gridViewModel) {
        var self = this;
        this.gridViewModel = gridViewModel; // the same as PersonList.viewModel

        this.PersonId = ko.observable(data.PersonId || 0)
        this.Name = ko.observable(data.Name || "")

        this.IsOnTwitter = ko.observable(data.IsOnTwitter : false)
        this.TwitterName = ko.observable(data.TwitterName || "")

        this.CityId = ko.observable(data.CityId || 11)
        this.chosenCity = ko.computed(function () {
            return CityList.getCity(this.CityId()) // from DB, rather than itemsAtPage
        }, this);

        // Instance properties, methods in base class SLEntity use these properties 
        this.isNew = ko.observable(data.isNew || false);
        this.rowDisplayMode = ko.observable(Person.DEFAULTS.rowDisplayMode);
    }

    Person.prototype = new SLEntity();

    Person.prototype.PersonId = ko.observable(0)
        .extend({
            primaryKey: true,
            //headerText: "Id",
            formLabel: "Id",
            width: "100px",
            defaultValue: function () { return this.getNextId() }
        });

    Person.prototype.Name = ko.observable("")
        .extend({
            headerText: "Name",
            formLabel: "Name",
            presentation: "bsPopoverLink", // form in bootstrap popover
            width: "200px",
            defaultValue: "",
            required: true,
            minLength: 2,
            pattern: { message: 'Please, start with uppercase !', params: '^([A-Z])+' }
        });

    Person.prototype.IsOnTwitter = ko.observable(false)
        .extend({
            formLabel: "On Twitter",
            defaultValue: false
        });

    Person.prototype.TwitterName = ko.observable("")
        .extend({
            headerText: "Twitter",
            formLabel: "Twitter name",
            width: "auto", // one of the columns with take rest of row space
            defaultValue: ""
        });


    Person.prototype.CityId = ko.observable(0)
        .extend({
            defaultValue: 101
        });

    Person.prototype.chosenCity = ko.observable()
        .extend({
            headerText: "City",
            formLabel: "City",
            width: "200px",
            sortable:false,
            presentation: "bsSelectCity"
            //presentation: "bsTypeaheadCity"
        });

    Person.prototype.editRow = ko.observable("")
        .extend({
            headerText: "",  //"Edit"
            sortable: false,
            width: "30px",
            presentation: "bsRowEditLink"
        });

    Person.prototype.deleteRow = ko.observable("")
        .extend({
            headerText: "", // "Delete"
            sortable: false,
            width: "30px",
            presentation: "bsRowDeleteLink"
        });
</code></pre>

<b><i>PersonList</i></b>
<pre><code class="javascript">
function SLGridViewModel(configuration) {
    this.itemsAtPage = ko.observableArray([]);
    ...
}

var PersonList = (function (DB) {

    var db = DB,
        PageSize = 5,
        Page = 1,
        Filter = "",
        OrderByColumn = "Name",
        Asc = true;

    var Subscribe = function (page, size) {
        var query = {
            filter: Filter || "",
            page: page || Page,
            pageSize: size || PageSize,
            orderBy: OrderByColumn,
            asc: Asc
        };
        db.Subscribe(query, PushInitialSet);
    }

    var PushInitialSet = function (set, maxPageIndex, nItems) {
        ko.mapping.fromJS(set, {
            key: function (person) {
                return ko.utils.unwrapObservable(person.PersonId);
            },
            create: function (options) {
                return new Person(options.data, gridViewModel);
            }
        }, gridViewModel.itemsAtPage);
        gridViewModel.nItems(nItems);
        gridViewModel.maxPageIndex(maxPageIndex);
    }

    var GetPerson = function (id) { return db.GetPerson(id) }
    var StorePerson = function (data) { db.StorePerson(data) }
    var UpdatePerson = function (data) { db.UpdatePerson(data)}
    var DeletePerson = function (person) { db.DeletePerson(person) }
    var GetNextId = function () { return db.GetMaxId() + 1;}

    function GridViewModel() {
        var self = this;

        // call from SLGrid.init()
        this.Subscribe = function (page, size) {
            Subscribe(page, size);
        }

        this.getItem = function (id) {
            return ko.utils.arrayFirst(ViewModel.itemsAtPage(), function (p) { // grep
                return p.PersonId() == id;
            });
        }

        this.update = function (person) { UpdatePerson(person); }
        this.store = function (person) { StorePerson(person); }
        this.remove = function (person) { DeletePerson(person); }

        this.canAdd = ko.computed(function () {
            return this.itemsAtPage().length < PageSize + 1;
        }, this)

        this.add = function () {
            var data = Person.prototype.defaultData(this);
            data = $.extend({}, data, { isNew: true }) // , isRowEdit: true
            this.isAdding(true);
            var person = ko.mapping.fromJS(data, {
                key: function (person) {
                    return ko.utils.unwrapObservable(person.PersonId);
                },
                create: function (options) {
                    return new Person(options.data, self); // self is gridViewModel
                }
            });
            this.itemsAtPage.push(person);
        }

    } // end of GridViewModel

    GridViewModel.prototype = new SLGridViewModel({
        listTpl: {
            listHeader: "People",
            textAdd: "Add Person",
            textPager: "People",
            filterInputId: "filterPersonList",
            tableBordered: true
        },
        orderByColumn: OrderByColumn,
        columns: Person.prototype.getGridColumns(OrderByColumn)
    })

    var gridViewModel = new GridViewModel();

    return {
        viewModel: gridViewModel
    }

})(new PersonDB());
</code></pre>

<b><i>PersonDB</i></b>
<pre><code class="javascript">
function PersonDB() {

    this.Items = [
    { PersonId: 1, Name: "Claire", TwitterName: "O'Donnell", IsOnTwitter: true, CityId: 104 },
    { PersonId: 2, Name: "Sven", TwitterName: "", IsOnTwitter: false, CityId: 101 },
    { PersonId: 3, Name: "Svetlana", TwitterName: "Omelchenko", IsOnTwitter: true, CityId: 104 },
    ...
    ];

    // override DBEntity.Subscribe
    this.Subscribe = function (query, callBack) {
        this.Start = (query.page - 1) * query.pageSize;
        this.End = this.Start + query.pageSize;
        $.ajax({
                url: "/People/GetPeople",
                data: { top: query.pageSize, 
                        skip: this.Start, 
                        filter: query.filter, 
                        orderby: query.orderBy },
                cache: false,
                success: function (data) {
                    that.MaxPageIndex = Math.ceil(data.nTotalItems / query.pageSize) - 1;
                    callBack(data.items, this.MaxPageIndex, this.Items.length)
                },
                failure: function (response) {
                    debugger
                }
            });
    }

    this.GetMaxId = function () {
        var arr = this.Items.map(function (data, i) {
            return data.PersonId;
        });
        return Math.max.apply(null, arr);
    }

    this.GetPerson = function (personId) {
        return ko.utils.arrayFirst(this.Items, function (p) {
            return p.PersonId == personId;
        });
        return null;
    }

    this.UpdatePerson = function (data) {
        var person = this.GetPerson(data.PersonId);
        $.each(person, function (name, value) {
            person[name] = data[name];
        });
    }

    this.StorePerson = function (data) {
        this.Items.push(data)
    }

    this.DeletePerson = function (entity) {
        var data = this.GetPerson(entity.PersonId());
        this.Items.splice($.inArray(data, this.Items), 1);
        setTimeout(function () { entity.onDeleted("ok", "deleted") }, 100);
    }

};

PersonDB.prototype = new DBEntity();
// instantiated at PersonList

</code></pre>

<b><i>Knockout widget: bsMoney</i></b>
<pre><code class="javascript">
ko.bindingHandlers.bsMoney = {

    init: function (element, valueAccessor, allBindings, viewModel, bindingContext) {
        var mode = viewModel.rowDisplayMode()
        var inRow = allBindings.get("inRow");
        var isViewMode = inRow && viewModel.isRowViewMode() || !inRow && viewModel.isViewMode()

        if (!isViewMode) {
            var colName = $(element).data("field");
            $(element).html("&lt;input style='text-align:right' class='form-control' data-field='" + 
                colName + "' data-bind=\"value: " + colName + "().toFixed(2), valueUpdate:'keyup'\"&gt;")
        }
    },

    update: function (element, valueAccessor, allBindings, viewModel, bindingContext) {
        var value = ko.utils.unwrapObservable(valueAccessor())
        var mode = viewModel.rowDisplayMode()
        var inRow = allBindings.get("inRow");
        var isViewMode = inRow && viewModel.isRowViewMode() || !inRow && viewModel.isViewMode()

        if (isViewMode) {
            var tokens = value.toFixed(2).replace('-', '').split('.');
            var s = '$' + $.map(tokens[0].split('').reverse(), function (elm, i) {
                return [(i % 3 === 0 && i > 0 ? ',' : ''), elm];
            }).reverse().join('') + '.' + tokens[1];
            var markup = value < 0 ? '-' + s : s;
            $(element).html(markup)
        }
    }
}

    </code></pre>

<h4>2) Add view model to global view model </h4>
<pre><code class="javascript">
        var globalViewModel = {
            ...
            cityList: CityList.viewModel,
            personList: PersonList.viewModel
        }

        $(document).ready(function () {
            ko.applyBindings(globalViewModel);
        });

</code></pre>
<br />
<h4>3) Create PersonList template, or default <b><i>EntityListTemplate</i></b>  will be used </h4>
<pre><code class="html"> 
&lt; script type="text/html" id="EntityListTemplate"&gt;
        &lt;div style="float:left"&gt;
            &lt;h4 data-bind="text:listHeader"&gt;&lt;/h4&gt; 
        &lt;/div&gt;

        &lt;div style="clear:both"&gt;&lt;/div&gt;

        &lt;div style="width:100%"&gt; 
            &lt;div data-bind="SLGrid: $data" /&gt; 
            &lt;div&gt;
                &lt;div style="float:left"&gt;
                    &lt;button class="btn btn-primary btn-xs" 
                        data-bind="click: add, enable: canAdd, text:textAdd"&gt;&lt;/button&gt;
                &lt;/div&gt;
                &lt;div style="float:right;" data-bind="SLGridPager: $data"&gt;
                &lt;/div&gt;
                &lt;div style="float:right; margin-right:20px;"&gt;
                    &lt;span data-bind='text: nItems'&gt;&lt;/span&gt; &lt;span data-bind='text:textPager'&gt;&lt;/span&gt;
                    &lt;span data-bind="visible:maxPageIndex()&gt;=itemsOnPager()"&gt;, 
                    &lt;span data-bind='text:maxPageIndex()+1'&gt;&lt;/span&gt; pages&lt;/span&gt;
                &lt;/div&gt;
                &lt;div style="clear:both"&gt;&lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/script&gt;
</code></pre>
<br />
<h4>4) Bind PersonTemplate to PersonList.viewModel  </h4>
<pre><code class="html"> 
    &lt;div data-bind="template: { 
              name: 'EntityListTemplate',
              data : personList, 
              afterRender: personList.afterRender }" &gt;
    &lt;/div&gt;
</code></pre>

            </div>
  

            <div id="AdminModulePanel" class="entity-panel" style="display:none;">
                <h3>Here is the sample of usage of SLGrid for <i><b>Admin Module</b></i> of Web Site</h3>
                <ul>
                    <li>
                    Provide Database Definition
                    <a href="SLGen.htm"> <i><b>Sample Database definition</b></i></a>
                    </li>
                    <li>
                        Run the Generator to create JavaScript classes, HTML Templates, Knockout widgets ...
                    </li>
                    <li>
                        <a href="KnockoutCRUD.htm"><i><b>Admin module</b></i></a> after generation. 
                    </li>
                </ul>
                 
                <br/>

                Generator reads definitions of Tables and Fields, and generates javascript classes (js files).<br/>
                It uses relation established between tables, and generates appropriate JavaScript code: 
                    <ul>
                    <li>js classes</li>
                    <li>HTML templates</li>
                    <li>Knockout widgets: dropdowns, typeaheads, date pickers ...</li>
                    <li>Expanding panels for 1:N relations beetween entities (tables)</li>
                    </ul>
                
                <br/>
                Each cell of SLGrid can host Knockout widget like dropdown, typeahead, date picker ...<br/>
                It easily to create Knockout widget and itegrate it with SLGrid.
                <br/>
                <br/>
                Generated JavaScript code can be easily extended with additional functionality and business logic.</br>
                Business logic can be complex, and users prefer custom events where they can write their custom code.</br>
                That way whole js code is in appropriate classes, and there is no JavaScript code at page (global) level.</br></br>
                Generator will keep user changes upon modification of Database Definition and regeneration of classes.</br></br>

                The core component is Knockout SLGrid which can host Knockout Widget in each cell column.</br>
                See feature: "Widgets".
                That way each table field can have its own presentation.

                <h2>Steps</h2>
                <br/>
                <ul>

                <li>
                    Generator will generate  <b>YourEntity</b> JavaScript classes based on template classes:<br/><br/>
                    &nbsp;&nbsp;&nbsp;Person.js => <b>YourEntity</b>.js<br/>
                    &nbsp;&nbsp;&nbsp;PersonList.js => <b>YourEntityList</b>.js<br/>
                    &nbsp;&nbsp;&nbsp;PersonDB.js => <b>YourEntityDB.js</b><br/><br/>
                </li>

                <li>
                    Add ViewModel to globalViewModel <br />
                    <pre><code class="javascript"> 
                    var globalViewModel = {
                        ...
                        yourEntityList: YourEntityList.viewModel
                    }
                </code></pre> 
                <br/>
                </li>

                <li>
                Optionally define <b><i>YouEntityList</i></b> template. Otherwise default <i>"EntityListTemplate"</i> will be used.
                <br />
                <br/>
                </li>

                <li>
                    Bind YourEntityTemplate to YourEntityList.viewModel
                <pre><code class="html"> 
                    &lt;div class="entity-list your-entity-list" style="width:80%" 
                        data-bind="template: {  name: 'EntityListTemplate',  
                                                data : yourEntityList, 
                                                afterRender: yourEntityList.afterRender }" &gt;
                    &lt;/div&gt;
                </code></pre>  
                </li>

                </ul>
            </div>

            <div id="PersonPanel" class="entity-panel" style="display:none;">
                <pre><code class="lang-javascript">    
                var <b>Person</b> = function () {
                    this.PersonId = ko.observable(data.PersonId || 0)
                    this.Name = ko.observable(data.Name || "")

                    this.TwitterName = 
                             ko.observable(data.TwitterName || "")
                    ...
                }

                Person.prototype.PersonId = ko.observable(0)
                    .extend({
                        primaryKey: true,
                        headerText: "Id",
                        formLabel: "Id",
                        width: "100px",
                        defaultValue: function () { 
                                         return this.getNextId() 
                                      }
                    });
                ...

                Person.prototype.chosenCity = ko.observable()
                        .extend({
                            headerText: "City",
                            formLabel: "City",
                            width: "200px",
                            //presentation: "bsDropDownCity"
                            presentation: <b style='color:maroon'>"bsTypeaheadCity"</b>
                        });
                ...
                </code></pre>   
            </div>

            <div id="PersonListPanel" class="entity-panel" style="display:none;">
                Hosts ViewModel for Person list. <br/>
                Uses module pattern to overcome the limitations of the object literal,<br/> 
                offering privacy for variables and functions while exposing a public API.<br/>
                <br/>
                <pre><code class="lang-javascript"> 
                var <b>PersonList</b> = (function (DB) {
                  var db = DB;

                  var StorePerson  = function (data) { 
                    db.StorePerson(data) 
                  }

                  var UpdatePerson = function (data) { 
                    db.UpdatePerson(data) 
                  }

                  var DeletePerson = function (personId) { 
                    db.DeletePerson(personId) 
                  }

                  function GridViewModel() {
                    ...
                    this.canAdd = ko.computed(function () {
                        return this.itemsAtPage().length < PageSize + 1;
                    }, this)

                    this.add = function () {
                    }
                    ...
                  }
                  GridViewModel.prototype = new SLGridViewModel();

                  var gridViewModel = new GridViewModel();
                  return {
                        viewModel: gridViewModel
                  }

                })(new PersonDB());    
                </code></pre>     
            </div>

            <div id="PersonDBPanel" class="entity-panel" style="display:none;">
                Work with Database (storage)<br/>
                Adapter can be:
                <ul>
                    <li>in-memory</li>
                    <li>ajax based</li>
                    <li>LightStreamer pusher</li>
                    <li>any custom adapter for specific DB</li>
                    </ul>
                <br />        

                <pre><code class="lang-javascript"> 
                function <b>PersonDB()</b> {

                  this.UpdatePerson = function (data) {
                    ...
                  }

                  this.StorePerson = function (data) {
                    ...
                  }

                  this.DeletePerson = function (id) {
                    ...
                  }
                }   
                PersonDB.prototype = new DBEntity(); 
                </code></pre>    
            </div>

            <div id="ViewModelsPanel" class="entity-panel" style="display:none;">
                ViewModels of all the entities are being used in global ViewModel like this: <br />
                <pre><code class="javascript"> 
                    var globalViewModel = {
                        personList: PersonList.viewModel,
                        cityList: CityList.viewModel,
                        categoryList: CategoryList.viewModel
                    }

                    $(document).ready(function () {
                        ko.applyBindings(globalViewModel);
                    });
                </code></pre>     
            </div>

            <div id="EntityListTemplatesPanel" class="entity-panel" style="display:none;">
                Here is the example of <b><i>PersonList</i></b> template.<br />
                As in all other cases, if you provide custom template it will be used.<br />
                Otherwise default <b><i>EntityListTemplate</i></b> will be used.
                <br />

                <pre><code class="html"> 
                &lt; script type="text/html" id="PersonList"&gt;
                        &lt;div style="float:left"&gt;
                             &lt;h4&gt;Team&lt;/h4&gt; 
                        &lt;/div&gt;

                        &lt;div class="form-group" style="float:left;margin:5px;width:200px !important;margin-left:50px;"&gt;
                            &lt;div class="input-group iiinput-group-sm"&gt;
                                &lt;input id="filterPersonList" type="text" class="form-control input-sm typeahead" style="padding:2px 6px;" /&gt;
                                &lt;span class="input-group-addon" style="padding:2px 6px;"&gt;
                                    &lt;i id='icon-typeahead' class="fa fa-filter" style="font-size:14px;"&gt;&lt;/i&gt;
                                &lt;/span&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;

                        &lt;div style="clear:both"&gt;&lt;/div&gt;

                        &lt;div style="width:100%"&gt; 
                            &lt;div data-bind="SLGrid: $data" /&gt;
                            &lt;div&gt;
                                &lt;div style="float:left"&gt; 
                                    &lt;button class="btn btn-primary" 
                                        data-bind="click: addPerson, enable: canAddPerson"&gt;Add Person&lt;/button&gt;
                                &lt;/div&gt;
                                &lt;div style="float:right;" data-bind="SLGridPager: $data"&gt;
                                &lt;/div&gt;
                                &lt;div style="float:right; margin-right:20px;"&gt;
                                    &lt;span data-bind='text: nItems'&gt;&lt;/span&gt; people&lt;span 
                                        data-bind="visible:maxPageIndex()&gt;=itemsOnPager()"&gt;, 
                                        &lt;span data-bind='text:maxPageIndex()+1'&gt;&lt;/span&gt; pages&lt;/span&gt;
                                &lt;/div&gt;
                                &lt;div style="clear:both"&gt;&lt;/div&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/script&gt;
                </code></pre>  
            </div>

            <div id="BindingsPanel" class="entity-panel" style="display:none;">
                Bind PersonTemplate to PersonList.viewModel

                <pre><code class="html"> 
                    &lt;div class="entity-list person-list" style="width:80%" 
                        data-bind="template: {  name: 'PersonList',  
                                                data : personList, 
                                                afterRender: personList.afterRender }" &gt;
                    &lt;/div&gt;
                </code></pre>  
            </div>


            <div id="WidgetsPanel" class="entity-panel" style="display:none;">
                We use widgets created by Knockout Custom Bindings.<br/>
                Each field can be presented in table row, or in Bootstrap form (popover) by different widget.<br/>
                See above mentioned widgets: bsDropDownCity or bsTypeheadCity.

                <pre><code class="javascript"> 
                ko.bindingHandlers.bsStatus = {
                    update: function (element, valueAccessor, allBindings, viewModel, bindingContext) {
                        var value = ko.utils.unwrapObservable(valueAccessor())
                        var mode = viewModel.rowDisplayMode()
                        var inRow = allBindings.get("inRow");
                        var isViewMode = inRow && viewModel.isRowViewMode() || !inRow && viewModel.isViewMode()
                        var markup = /*isViewMode ?*/
                            (value == 1 ? "<span class='badge alert-success'>Success</span>" : "<span class='badge alert-danger'>Failure</span>")

                        $(element).html(markup)
                    }
                }
                </code></pre>  
                That widget can be used like this<br/>
                <pre><code class="javascript"> 
                    BlogPost.prototype.status = ko.observable("")
                        .extend({
                            headerText: "Status",
                            formLabel: "Status",
                            presentation: "bsStatus",
                            width: "30px"
                        });
                </code></pre>  
            </div>

            <div id="RelationsPanel" class="entity-panel" style="display:none;">
                Generator delivers UI (HTML and JavaScript code) for presentation of 1:N relations taken from Database Definition.
                <br /><br />
                For example: <br />
                <ul>
                    <li>Person has Posts<br /><img src="Images/PersonPosts.png" /></li>
                    <li style='margin-top:5px;'>Category has Posts<br /><img src="Images/CategoryPosts.png" /></li>
                </ul>
                 
            </div>

          </div>
        </div>
      </div>
    </div>


<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/styles/default.min.css">
<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/highlight.min.js"></script>


    <script type="text/html" id="EntityListTemplate">
        <div style="float:left">
             <h4 data-bind="text:listHeader"></h4> 
        </div>

        <div style="clear:both"></div>

        <div style="width:100%"> 
            <div data-bind="SLGrid: $data" /> 
            <div>
                <div style="float:left">
                    <button class="btn btn-primary btn-xs" data-bind="click: add, enable: canAdd, text:textAdd"></button>
                </div>
                <div style="float:right;" data-bind="SLGridPager: $data">
                </div>
                <div style="float:right; margin-right:20px;">
                    <span data-bind='text: nItems'></span> <span data-bind='text:textPager'></span><span data-bind="visible:maxPageIndex()>=itemsOnPager()">, <span data-bind='text:maxPageIndex()+1'></span> pages</span>
                </div>
                <div style="clear:both"></div>
            </div>
        </div>
    </script>


    <script type="text/javascript">
        $(document).ready(function () {
            //hljs.configure({language: 'JavaScript'});
            $('pre code').each(function (i, block) {
                hljs.highlightBlock(block);
            });

            $('.nav-sidebar > li > a').click(function () {
                var $li = $('.nav-sidebar > li.active');
                $('#' + $li.attr('id') + 'Panel').slideUp('slow');
                $li.removeClass('active');

                $li = $(this).parent();
                $('#' + $li.attr('id') + 'Panel').slideDown('slow');
                $li.addClass('active');
            }); 

            $('.nav-sidebar > li.active > a').trigger('click');
        });
    </script>

    <script type="text/javascript">
        var globalViewModel = {
        }

        $(document).ready(function () {
            //ko.applyBindings(globalViewModel);
        });

        $(document).on('click', function (e) {
            if ($(e.target).closest(".popover").length == 0) { // click out of the popover 
                $(".popoverShown").popover("hide"); // hide all
            }
        });

    </script>

    <a title="Web Statistics" href="http://clicky.com/100779018"><img alt="Web Statistics" src="//static.getclicky.com/media/links/badge.gif" border="0" /></a>
    <script src="//static.getclicky.com/js" type="text/javascript"></script>
    <script type="text/javascript">    try { clicky.init(100779018); } catch (e) { }</script>
    <noscript><p><img alt="Clicky" width="1" height="1" src="//in.getclicky.com/100779018ns.gif" /></p></noscript>

  </body>
</html>