
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>

<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/styles/default.min.css">
<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/highlight.min.js"></script>


Knockout CRUD with Bootstrap forms

<br/>
<br/>
<br/>

<a href="SLGen.htm"> <i>SLGen</i> Generator </a>
<br/><br/>

SLGen reads definitions of fields of table, and generate the classes (js files)
<br/><br/>
&nbsp;Person.js => YourEntity.js<br/>
&nbsp;PersonList.js => YourEntityList.js<br/>
&nbsp;PersonDB.js => YourEntityDB.js<br/>
<br/>
Generated classes are ready for upgrading with additional functionality and business logic.</br>
That way there is no javascript code at page (global) level.</br>
Generator will keep user code upon regeneration of classes.
</br>

<table border=1 cellpadding=5 cellspacing=0 width=90% style='margin-left:10px;'>
<tr>
    <th width=33%><b>Person</b></th>
    <th><b>PersonList</b></th>
    <th><b>PersonDB</b></th>
</tr>
<tr>
    <td>
    
<pre><code class="lang-javascript">    
var <b>Person</b> = function () {
    this.PersonId = ko.observable(data.PersonId || 0)
    this.Name = ko.observable(data.Name || "")

    this.TwitterName = ko.observable(data.TwitterName || "")
    ...
}

Person.prototype.PersonId = ko.observable(0)
    .extend({
        primaryKey: true,
        headerText: "Id",
        formLabel: "Id",
        width: "100px",
        defaultValue: function () { return this.getNextId() }
    });
...

Person.prototype.chosenCity = ko.observable()
        .extend({
            headerText: "City",
            formLabel: "City",
            width: "200px",
            //presentation: "bsDropDownCity"
            presentation: <b style='color:maroon'>"bsTypeaheadCity"</b>
        });
...
</code></pre>        
        
    
    </td>
    <td>
Keeps ViewModel for Person. <br/><br/>
Uses module pattern to overcome the limitations of the object literal, offering privacy for variables and functions while exposing a public API.<br/>
<br/>
<pre><code class="lang-javascript"> 
var <b>PersonList</b> = (function (DB) {
  
  var StorePerson  = function (data) { 
    db.StorePerson(data) 
  }

  var UpdatePerson = function (data) { 
    db.UpdatePerson(data) 
  }

  var DeletePerson = function (personId) { 
    db.DeletePerson(personId) 
  }

  function GridViewModel() {
    ...
  }
  GridViewModel.prototype = new SLGridViewModel();

  var gridViewModel = new GridViewModel();
  return {
        viewModel: gridViewModel
  }
}    
</code></pre>     
    </td>
    
    <td>
Work with Database (storage)<br/>
Can be in memory adapter, ajax based adapter, LightStreamer pusher ...
<br/>
<br/>
<pre><code class="lang-javascript"> 
function <b>PersonDB()</b> {

  this.UpdatePerson = function (data) {
    ...
  }

  this.StorePerson = function (data) {
    ...
  }

  this.DeletePerson = function (id) {
    ...
  }
}    
</code></pre>     
    </td>
    </tr>
    
<tr><td colspan='3'>
ViewModels of all the entities are being used in global VieewModel like this: <br />
<pre><code class="javascript"> 
    var globalViewModel = {
        personListViewModel: PersonList.viewModel,
        cityListViewModel: CityList.viewModel
    }

    $(document).ready(function () {
        ko.applyBindings(globalViewModel);
    });
</code></pre>     
</td></tr>    

<tr><td colspan='3'>
Here is the example of PersonList template.<br />
It is rasier to change this template, than learn a new API for definition of layout.<br />

<pre><code class="html"> 
&lt;script type="text/html" id="PersonList"&gt;
        &lt;div style="float:left">
             &lt;h4>Team&lt;/h4> 
        &lt;/div>

        &lt;div class="form-group" style="float:left;margin:5px;width:200px !important;margin-left:50px;">
            &lt;div class="input-group iiinput-group-sm">
                &lt;input id="filterPersonList" type="text" class="form-control input-sm typeahead" style="padding:2px 6px;" />
                &lt;span class="input-group-addon" style="padding:2px 6px;">&lt;i id='icon-typeahead' class="fa fa-filter" style="font-size:14px;">&lt;/i>&lt;/span>
            &lt;/div>
        &lt;/div>

        &lt;div style="clear:both">&lt;/div>

        &lt;div style="width:100%"> 
            &lt;div data-bind="SLGrid: $data" /> 
            &lt;div>
                &lt;div style="float:left">
                    &lt;button class="btn btn-primary" data-bind="click: addPerson, enable: canAddPerson">Add Person&lt;/button>
                &lt;/div>
                &lt;div style="float:right;" data-bind="SLGridPager: $data">
                &lt;/div>
                &lt;div style="float:right; margin-right:20px;">
                    &lt;span data-bind='text: nItems'>&lt;/span> people&lt;span data-bind="visible:maxPageIndex()>=itemsOnPager()">, &lt;span data-bind='text:maxPageIndex()+1'>&lt;/span> pages&lt;/span>
                &lt;/div>
                &lt;div style="clear:both">&lt;/div>
            &lt;/div>
        &lt;/div>
    &lt;/script&gt;
</code></pre>  

</td></tr>

<tr><td colspan='3'>
Finally bind PersonTemplate to PersonList.viewModel

<pre><code class="html"> 
    &lt;div class="entity-list person-list" style="width:80%" data-bind="template: { name: 'PersonList',  data : personListViewModel, afterRender: personListViewModel.afterRender }">
    &lt;/div>
</code></pre>  

</td></tr>
    </table>

<br/><br/>
We use widgets created by Knockout Custom Bindings.<br/>
Each field can be presenteted in table row, or in Bootstrap form (popover) by different widget.<br/>
See above mentioned widgets: bsDropDownCity or bsTypeheadCity.<br/>

<br/><br/><br/>
<b><i>Example of maintenance of Person table, using generated files for Person entity</i></b> <br/>
<a href="CRUD.htm">Person</a>
<br/><br/><br/>


<script type="text/javascript">
    $(document).ready(function () {
        //hljs.configure({language: 'JavaScript'});
        $('pre code').each(function (i, block) {
            hljs.highlightBlock(block);
        });
    });
</script>
