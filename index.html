<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'/>

    <meta name="description" content="Knockout CRUD">
    <meta name="author" content="Slavko">
    <link rel="icon" href="favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <meta http-equiv="PRAGMA" content="NO-CACHE" />

    <title>Admin Module</title>
  
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.css" rel="stylesheet" type="text/css" />
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.css" rel="stylesheet" type="text/css" />

    <link href="css/font-awesome.css" rel="stylesheet" type="text/css" />
    <link href="css/SLGrid.css" rel="stylesheet" type="text/css" />

    <!-- Custom styles for this template -->
    <link href="css/dashboard.css" rel="stylesheet" />

    <style type="text/css">
        @import url(//fonts.googleapis.com/css?family=Kaushan+Script);
        .navbar-brand 
        {
            font-size: 20px;
            font-family: 'Kaushan Script', cursive;
        }
    </style>

    <style type="text/css">
        body { font-family: 'Source Sans Pro', sans-serif; }
        td { padding:10px;  vertical-align:text-top; }
    </style>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.2.0/js/bootstrap.min.js"></script>
 
    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="js/ie-emulation-modes-warning.js"></script>
    <script src="js/docs.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="js/ie10-viewport-bug-workaround.js"></script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script type="text/javascript">
        function Trace(obj) {
            if (window.console && window.console.log)
                window.console.log(obj.toString());
        }
    </script>

  </head>

  <body>

 <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">KnockoutCRUD </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="#">Dashboard</a></li>
            <li><a href="#">Settings</a></li>
            <li><a href="#">Profile</a></li>
            <li><a href="#">Help</a></li>
          </ul>
          <form class="navbar-form navbar-right">
            <input type="text" class="form-control" placeholder="Search...">
          </form>
        </div>
      </div>
    </nav>

    <div class="container-fluid">
      <div class="row">

        <div class="col-sm-3 col-md-2 sidebar">
           
          <div class="well"> 
          <ul class="nav nav-sidebar">
            <li id="Overview" class="active"><a href="#">Overview</a></li>
          </ul>
          </div>

          <div class="well"> 
           <i>Steps</i>
          <ul class="nav nav-sidebar">
            <li id="Person"><a href="#">Person</a></li>
            <li id="PersonList"><a href="#">PersonList</a></li>
            <li id="PersonDB"><a href="#">PersonDB</a></li>
            <li id="ViewModels"><a href="#">View Models</a></li>
            <li id="EntityListTemplates"><a href="#">List templates</a></li>
            <li id="Bindings"><a href="#">Bindings</a></li>
          </ul>
          </div>

          <div class="well"> 
          <i>Features</i>
          <ul class="nav nav-sidebar">
            <li id="Widgets"><a href="#">Widgets</a></li>
            <li id="Relations"><a href="#">1:N Relations</a></li>
          </ul>
          </div>
        </div>

        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
          <h2 class="page-header">Knockout CRUD with Bootstrap forms</h2>

          <div class="row placeholders">
            <div class="col-xs-6 col-sm-3 placeholder">
              <img data-src="holder.js/40x40/auto/sky" class="img-responsive" alt="Generic placeholder thumbnail">
              <h4>Label</h4>
              <span class="text-muted">Something else</span>
            </div>
            <div class="col-xs-6 col-sm-3 placeholder">
              <img data-src="holder.js/40x40/auto/vine" class="img-responsive" alt="Generic placeholder thumbnail">
              <h4>Label</h4>
              <span class="text-muted">Something else</span>
            </div>
            <div class="col-xs-6 col-sm-3 placeholder">
              <img data-src="holder.js/40x40/auto/sky" class="img-responsive" alt="Generic placeholder thumbnail">
              <h4>Label</h4>
              <span class="text-muted">Something else</span>
            </div>
            <div class="col-xs-6 col-sm-3 placeholder">
              <img data-src="holder.js/40x40/auto/vine" class="img-responsive" alt="Generic placeholder thumbnail">
              <h4>Label</h4>
              <span class="text-muted">Something else</span>
            </div>
          </div>

          <!--<h2 class="sub-header">Section</h2>-->
          <div class="table-responsive">

            <div id="OverviewPanel" class="entity-panel" style="display:none;">

                <h3>Here is the sample of usage for <i><b>Admin Module</b></i> of Web Site</h3>
                <ul>
                    <li>
                    Provide Database Definition
                    <a href="SLGen.htm"> <i><b>Sample Database definition</b></i></a>
                    </li>
                    <li>
                        Generate of JavaScript classes, HTML templates, Knockout widgets ...
                    </li>
                    <li>
                        <a href="KnockoutCRUD.htm"><i><b>Admin module</b></i></a> after generation. 
                    </li>
                </ul>
                 
                <br/>

                Generator reads definitions of Tables and Fields, and generates javascript classes (js files).<br/>
                It uses relation established between tables, and generates appropriate JavaScript code: 
                    <ul>
                    <li>js classes</li>
                    <li>HTML templates</li>
                    <li>Knockout widgets: dropdowns, typeaheads, date pickers ...</li>
                    <li>Expanding panels for 1:N relations beetween entities (tables)</li>
                    </ul>
                
                <br/>
                Each cell of SLGrid can host Knockout widget like dropdown, typeahead, date picker ...<br/>
                It easily to create Knockout widget and itegrate it with SLGrid.
                <br/>
                <br/>
                Generated JavaScript code can be easily extended with additional functionality and business logic.</br>
                Business logic can be complex, and users prefer custom events where they can write their custom code.</br>
                That way whole js code is in appropriate classes, and there is no JavaScript code at page (global) level.</br></br>
                Generator will keep user changes upon modification of Database Definition and regeneration of classes.</br></br>

                The core component is Knockout SLGrid which can host Knockout Widget in each cell column.</br>
                See feature: "Widgets".
                That way each table field can have its own presentation.

                <h2>Steps</h2>
                <br/>
                <ul>

                <li>
                    Generator will generate  <b>YourEntity</b> JavaScript classes based on template classes:<br/><br/>
                    &nbsp;&nbsp;&nbsp;Person.js => <b>YourEntity</b>.js<br/>
                    &nbsp;&nbsp;&nbsp;PersonList.js => <b>YourEntityList</b>.js<br/>
                    &nbsp;&nbsp;&nbsp;PersonDB.js => <b>YourEntityDB.js</b><br/><br/>
                </li>

                <li>
                    Add ViewModel to globalViewModel <br />
                    <pre><code class="javascript"> 
                    var globalViewModel = {
                        ...
                        yourEntityList: YourEntityList.viewModel
                    }
                </code></pre> 
                <br/>
                </li>

                <li>
                Optionally define <b><i>YouEntityList</i></b> template. Otherwise default <i>"EntityListTemplate"</i> will be used.
                <br />
                <br/>
                </li>

                <li>
                    Bind YourEntityTemplate to YourEntityList.viewModel
                <pre><code class="html"> 
                    &lt;div class="entity-list your-entity-list" style="width:80%" 
                        data-bind="template: {  name: 'EntityListTemplate',  
                                                data : yourEntityList, 
                                                afterRender: yourEntityList.afterRender }" &gt;
                    &lt;/div&gt;
                </code></pre>  
                </li>

                </ul>
                

               
            </div>
  
            <div id="PersonPanel" class="entity-panel" style="display:none;">
                <pre><code class="lang-javascript">    
                var <b>Person</b> = function () {
                    this.PersonId = ko.observable(data.PersonId || 0)
                    this.Name = ko.observable(data.Name || "")

                    this.TwitterName = 
                             ko.observable(data.TwitterName || "")
                    ...
                }

                Person.prototype.PersonId = ko.observable(0)
                    .extend({
                        primaryKey: true,
                        headerText: "Id",
                        formLabel: "Id",
                        width: "100px",
                        defaultValue: function () { 
                                         return this.getNextId() 
                                      }
                    });
                ...

                Person.prototype.chosenCity = ko.observable()
                        .extend({
                            headerText: "City",
                            formLabel: "City",
                            width: "200px",
                            //presentation: "bsDropDownCity"
                            presentation: <b style='color:maroon'>"bsTypeaheadCity"</b>
                        });
                ...
                </code></pre>   
            </div>

            <div id="PersonListPanel" class="entity-panel" style="display:none;">
                Hosts ViewModel for Person list. <br/>
                Uses module pattern to overcome the limitations of the object literal,<br/> 
                offering privacy for variables and functions while exposing a public API.<br/>
                <br/>
                <pre><code class="lang-javascript"> 
                var <b>PersonList</b> = (function (DB) {
                  var db = DB;

                  var StorePerson  = function (data) { 
                    db.StorePerson(data) 
                  }

                  var UpdatePerson = function (data) { 
                    db.UpdatePerson(data) 
                  }

                  var DeletePerson = function (personId) { 
                    db.DeletePerson(personId) 
                  }

                  function GridViewModel() {
                    ...
                    this.canAdd = ko.computed(function () {
                        return this.itemsAtPage().length < PageSize + 1;
                    }, this)

                    this.add = function () {
                    }
                    ...
                  }
                  GridViewModel.prototype = new SLGridViewModel();

                  var gridViewModel = new GridViewModel();
                  return {
                        viewModel: gridViewModel
                  }

                })(new PersonDB());    
                </code></pre>     
            </div>

            <div id="PersonDBPanel" class="entity-panel" style="display:none;">
                Work with Database (storage)<br/>
                Adapter can be:
                <ul>
                    <li>in-memory</li>
                    <li>ajax based</li>
                    <li>LightStreamer pusher</li>
                    <li>any custom adapter for specific DB</li>
                    </ul>
                <br />        

                <pre><code class="lang-javascript"> 
                function <b>PersonDB()</b> {

                  this.UpdatePerson = function (data) {
                    ...
                  }

                  this.StorePerson = function (data) {
                    ...
                  }

                  this.DeletePerson = function (id) {
                    ...
                  }
                }   
                PersonDB.prototype = new DBEntity(); 
                </code></pre>    
            </div>

            <div id="ViewModelsPanel" class="entity-panel" style="display:none;">
                ViewModels of all the entities are being used in global ViewModel like this: <br />
                <pre><code class="javascript"> 
                    var globalViewModel = {
                        personList: PersonList.viewModel,
                        cityList: CityList.viewModel,
                        categoryList: CategoryList.viewModel
                    }

                    $(document).ready(function () {
                        ko.applyBindings(globalViewModel);
                    });
                </code></pre>     
            </div>

            <div id="EntityListTemplatesPanel" class="entity-panel" style="display:none;">
                Here is the example of <b><i>PersonList</i></b> template.<br />
                As in all other cases, if you provide custom template it will be used.<br />
                Otherwise default <b><i>EntityListTemplate</i></b> will be used.
                <br />

                <pre><code class="html"> 
                &lt; script type="text/html" id="PersonList"&gt;
                        &lt;div style="float:left"&gt;
                             &lt;h4&gt;Team&lt;/h4&gt; 
                        &lt;/div&gt;

                        &lt;div class="form-group" style="float:left;margin:5px;width:200px !important;margin-left:50px;"&gt;
                            &lt;div class="input-group iiinput-group-sm"&gt;
                                &lt;input id="filterPersonList" type="text" class="form-control input-sm typeahead" style="padding:2px 6px;" /&gt;
                                &lt;span class="input-group-addon" style="padding:2px 6px;"&gt;
                                    &lt;i id='icon-typeahead' class="fa fa-filter" style="font-size:14px;"&gt;&lt;/i&gt;
                                &lt;/span&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;

                        &lt;div style="clear:both"&gt;&lt;/div&gt;

                        &lt;div style="width:100%"&gt; 
                            &lt;div data-bind="SLGrid: $data" /&gt;
                            &lt;div&gt;
                                &lt;div style="float:left"&gt; 
                                    &lt;button class="btn btn-primary" 
                                        data-bind="click: addPerson, enable: canAddPerson"&gt;Add Person&lt;/button&gt;
                                &lt;/div&gt;
                                &lt;div style="float:right;" data-bind="SLGridPager: $data"&gt;
                                &lt;/div&gt;
                                &lt;div style="float:right; margin-right:20px;"&gt;
                                    &lt;span data-bind='text: nItems'&gt;&lt;/span&gt; people&lt;span 
                                        data-bind="visible:maxPageIndex()&gt;=itemsOnPager()"&gt;, 
                                        &lt;span data-bind='text:maxPageIndex()+1'&gt;&lt;/span&gt; pages&lt;/span&gt;
                                &lt;/div&gt;
                                &lt;div style="clear:both"&gt;&lt;/div&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/script&gt;
                </code></pre>  
            </div>

            <div id="BindingsPanel" class="entity-panel" style="display:none;">
                Bind PersonTemplate to PersonList.viewModel

                <pre><code class="html"> 
                    &lt;div class="entity-list person-list" style="width:80%" 
                        data-bind="template: {  name: 'PersonList',  
                                                data : personList, 
                                                afterRender: personList.afterRender }" &gt;
                    &lt;/div&gt;
                </code></pre>  
            </div>


            <div id="WidgetsPanel" class="entity-panel" style="display:none;">
                We use widgets created by Knockout Custom Bindings.<br/>
                Each field can be presented in table row, or in Bootstrap form (popover) by different widget.<br/>
                See above mentioned widgets: bsDropDownCity or bsTypeheadCity.

                <pre><code class="javascript"> 
                ko.bindingHandlers.bsStatus = {
                    update: function (element, valueAccessor, allBindings, viewModel, bindingContext) {
                        var value = ko.utils.unwrapObservable(valueAccessor())
                        var mode = viewModel.rowDisplayMode()
                        var inRow = allBindings.get("inRow");
                        var isViewMode = inRow && viewModel.isRowViewMode() || !inRow && viewModel.isViewMode()
                        var markup = /*isViewMode ?*/
                            (value == 1 ? "<span class='badge alert-success'>Success</span>" : "<span class='badge alert-danger'>Failure</span>")

                        $(element).html(markup)
                    }
                }
                </code></pre>  
                That widget can be used like this<br/>
                <pre><code class="javascript"> 
                    BlogPost.prototype.status = ko.observable("")
                        .extend({
                            headerText: "Status",
                            formLabel: "Status",
                            presentation: "bsStatus",
                            width: "30px"
                        });
                </code></pre>  
            </div>

            <div id="RelationsPanel" class="entity-panel" style="display:none;">
                Generator delivers UI (HTML and JavaScript code) for presentation of 1:N relations taken from Database Definition.
                <br /><br />
                For example: <br />
                <ul>
                    <li>Person has Posts<br /><img src="Images/PersonPosts.png" /></li>
                    <li style='margin-top:5px;'>Category has Posts<br /><img src="Images/CategoryPosts.png" /></li>
                </ul>
                 
            </div>

          </div>
        </div>
      </div>
    </div>


<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/styles/default.min.css">
<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.2/highlight.min.js"></script>




<script type="text/javascript">
    $(document).ready(function () {
        //hljs.configure({language: 'JavaScript'});
        $('pre code').each(function (i, block) {
            hljs.highlightBlock(block);
        });

        $('.nav-sidebar > li > a').click(function () {
            var $li = $('.nav-sidebar > li.active');
            $('#' + $li.attr('id') + 'Panel').slideUp('slow');
            $li.removeClass('active');

            $li = $(this).parent();
            $('#' + $li.attr('id') + 'Panel').slideDown('slow');
            $li.addClass('active');
        });

        $('.nav-sidebar > li.active > a').trigger('click');

    });

</script>

 
  </body>
</html>